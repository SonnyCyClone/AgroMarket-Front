<header class="header">
  <div class="header-container">
    <div class="logo-section">
      <img 
        id="header-logo" 
        [src]="'https://fv5-3.files.fm/thumb_show.php?i=b4pe5cj5nf&view&v=1&PHPSESSID=1f0e1a250256472c187f6bea04f6f371df64194d'" 
        alt="Logo AgroMarket" 
        (error)="onHeaderLogoError($event)"
        class="logo-icon"
      />
      <h1 class="logo" (click)="onLogoClick()">AgroMarket</h1>
    </div>
    
    <div class="search-section">
      <app-search-bar></app-search-bar>
    </div>
    
    <div class="actions-section">
      <button 
        id="header-register-product-button"
        *ngIf="isLoggedIn" 
        class="register-button" 
        (click)="onRegisterProductClick()"
      >
        Registrar Producto
      </button>
      
      <button 
        id="header-cart-button"
        class="icon-button cart-button" 
        aria-label="Ver carrito de compras"
      >
        <span class="icon">ðŸ›’</span>
        <span class="label">Carrito</span>
      </button>
      
      <div class="user-actions">
        <!-- User Dropdown for Non-Logged Users -->
        <div *ngIf="!isLoggedIn" class="user-dropdown-container">
          <button 
            id="header-user-dropdown-button"
            class="icon-button user-button"
            (click)="onUserDropdownToggle($event)"
            (mouseenter)="showUserDropdown = true"
            aria-label="Opciones de usuario"
            aria-expanded="{{showUserDropdown}}"
            aria-haspopup="menu"
          >
            <span class="icon">ðŸ‘¤</span>
            <span class="label">Cuenta</span>
            <span class="dropdown-arrow">â–¼</span>
          </button>
          
          <div 
            *ngIf="showUserDropdown" 
            class="user-dropdown"
            (mouseleave)="showUserDropdown = false"
            role="menu"
            aria-label="MenÃº de opciones de usuario"
          >
            <button 
              id="header-login-dropdown-button"
              class="dropdown-item" 
              (click)="onLoginClick()"
              (keydown.enter)="onLoginClick()"
              (keydown.space)="onLoginClick()"
              role="menuitem"
            >
              <span class="dropdown-icon">ðŸ”‘</span>
              Iniciar SesiÃ³n
            </button>
            <button 
              id="header-register-dropdown-button"
              class="dropdown-item" 
              (click)="onRegisterClick()"
              (keydown.enter)="onRegisterClick()"
              (keydown.space)="onRegisterClick()"
              role="menuitem"
            >
              <span class="dropdown-icon">ðŸ”“</span>
              Crear Cuenta
            </button>
          </div>
        </div>
        
        <!-- Logged User Menu -->
        <div *ngIf="isLoggedIn" class="user-menu">
          <div class="user-info">
            <span class="user-name">{{ userDisplayName }}</span>
          </div>
          <button 
            id="header-logout-button"
            class="logout-button" 
            (click)="onLogout()" 
            aria-label="Cerrar sesiÃ³n"
          >
            Cerrar SesiÃ³n
          </button>
        </div>
      </div>
    </div>
  </div>
</header>
